<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 3.14.0"/><link as="script" rel="preload" href="/DemoGatsby/webpack-runtime-4fdd00d27d183d75dcd4.js"/><link as="script" rel="preload" href="/DemoGatsby/framework-33b76a5d919ecf8a8684.js"/><link as="script" rel="preload" href="/DemoGatsby/app-444659934cb01ee83c7c.js"/><link as="script" rel="preload" href="/DemoGatsby/5b193f6accaeb9908c3d71638f39c22a959f684d-91cf4c8dc2f322fa6180.js"/><link as="script" rel="preload" href="/DemoGatsby/component---src-pages-deepdive-gatsby-plugins-js-1d2f0cc300cd9a0df475.js"/><link as="fetch" rel="preload" href="/DemoGatsby/page-data/deepdive/gatsby/plugins/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/DemoGatsby/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><main><title>Plugin loading</title><p>The bootstrap loads plugins</p><a href="https://github.com/gatsbyjs/gatsby/blob/17a3f9f69ae2710f4aeef27603226281f2713281/packages/gatsby/src/bootstrap/index.ts#L55" rel="noreferrer" target="_blank">loadConfigAndPlugins</a><a href="https://github.com/gatsbyjs/gatsby/blob/17a3f9f69ae2710f4aeef27603226281f2713281/packages/gatsby/src/utils/worker/child/load-config-and-plugins.ts" rel="noreferrer" target="_blank">loadConfigAndPlugins</a><p>Note the <code>apiRunnerNode(`onPluginInit`)</code> that will will run the plugin init gatsby node api method for all plugins.</p><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff"><code class="language-javascript" style="white-space:pre"><span>
</span><span></span><span style="color:#954121">import</span><span> { loadConfigAndPlugins </span><span style="color:#954121">as</span><span> internalLoadConfigAndPlugins } </span><span style="color:#954121">from</span><span> </span><span style="color:#219161">&quot;../../../bootstrap/load-config-and-plugins&quot;</span><span>
</span><span></span><span style="color:#954121">import</span><span> { store } </span><span style="color:#954121">from</span><span> </span><span style="color:#219161">&quot;../../../redux&quot;</span><span>
</span><span></span><span style="color:#954121">import</span><span> apiRunnerNode </span><span style="color:#954121">from</span><span> </span><span style="color:#219161">&quot;../../api-runner-node&quot;</span><span>
</span>
<span></span><span style="color:#954121">export</span><span> </span><span style="color:#954121">async</span><span> </span><span class="hljs-function" style="color:#954121">function</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#458;font-weight:bold">loadConfigAndPlugins</span><span class="hljs-function">(</span><span class="hljs-function" style="color:#00f">
</span><span class="hljs-function" style="color:#00f">  ...args: Parameters&lt;</span><span class="hljs-function" style="color:#954121">typeof</span><span class="hljs-function" style="color:#00f"> internalLoadConfigAndPlugins&gt;
</span><span class="hljs-function" style="color:#00f"></span><span class="hljs-function">): </span><span class="hljs-function" style="color:#458;font-weight:bold">Promise</span><span class="hljs-function">&lt;</span><span class="hljs-function" style="color:#458;font-weight:bold">void</span><span class="hljs-function">&gt; </span><span>{
</span><span>  </span><span style="color:#954121">const</span><span> [{ siteDirectory, program }] = args
</span>
<!-- -->  store.dispatch({
<span>    </span><span class="hljs-attr">type</span><span>: </span><span style="color:#219161">`SET_PROGRAM`</span><span>,
</span><span>    </span><span class="hljs-attr">payload</span><span>: {
</span>      ...program,
<span>      </span><span class="hljs-attr">directory</span><span>: siteDirectory,
</span>    },
<!-- -->  })
<span>  </span><span style="color:#954121">await</span><span> internalLoadConfigAndPlugins(...args)
</span>
<span>  </span><span style="color:#408080;font-style:italic">// Cache is already initialized</span><span>
</span><span>  </span><span style="color:#954121">if</span><span> (_CFLAGS_.GATSBY_MAJOR === </span><span style="color:#219161">`4`</span><span>) {
</span><span>    </span><span style="color:#954121">await</span><span> apiRunnerNode(</span><span style="color:#219161">`onPluginInit`</span><span>)
</span><span>  } </span><span style="color:#954121">else</span><span> {
</span><span>    </span><span style="color:#954121">await</span><span> apiRunnerNode(</span><span style="color:#219161">`unstable_onPluginInit`</span><span>)
</span>  }
<!-- -->}
<!-- -->
</code></pre><a href="https://github.com/gatsbyjs/gatsby/blob/17a3f9f69ae2710f4aeef27603226281f2713281/packages/gatsby/src/bootstrap/load-config-and-plugins.ts#L97" rel="noreferrer" target="_blank">loadConfigAndPlugins</a><a href="https://github.com/gatsbyjs/gatsby/blob/17a3f9f69ae2710f4aeef27603226281f2713281/packages/gatsby/src/bootstrap/load-plugins/index.ts#L100" rel="noreferrer" target="_blank">loadPlugins</a><p><b>The actual logic !</b><a href="https://github.com/gatsbyjs/gatsby/blob/17a3f9f69ae2710f4aeef27603226281f2713281/packages/gatsby/src/bootstrap/load-plugins/load.ts#L179" rel="noreferrer" target="_blank">loadPlugins</a></p><p>Following the code we can see that plugins are <a href="https://github.com/gatsbyjs/gatsby/tree/17a3f9f69ae2710f4aeef27603226281f2713281/packages/gatsby/src/internal-plugins" rel="noreferrer" target="_blank">internal plugins</a>, <a href="https://github.com/gatsbyjs/gatsby/tree/17a3f9f69ae2710f4aeef27603226281f2713281/packages/gatsby-plugin-typescript" rel="noreferrer" target="_blank">gatsby-plugin-typescript</a>, plugins in config ( both npm and local), the default page creator <a href="https://github.com/gatsbyjs/gatsby/tree/master/packages/gatsby-plugin-page-creator" rel="noreferrer" target="_blank">gatsby-plugin-page-creator</a> with options to source from src/pages ( unless explicitly provided ) and a default-site-plugin representing the loose files.</p><p>A list of the functions implemented by each plugin for the 3 apis is determined.  For gatsby-node.js the module is required.  For the other two they are parsed.</p></main></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/deepdive/gatsby/plugins/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-fd5502421d629d1c910a.js"],"app":["/app-444659934cb01ee83c7c.js"],"component---src-pages-404-js":["/component---src-pages-404-js-da19968e4b00979f9461.js"],"component---src-pages-deepdive-cli-js":["/component---src-pages-deepdive-cli-js-0f18bb1c833ee538d1f1.js"],"component---src-pages-deepdive-gatsby-apicalls-node-creating-nodes-js":["/component---src-pages-deepdive-gatsby-apicalls-node-creating-nodes-js-221ff46555a3e8320634.js"],"component---src-pages-deepdive-gatsby-apicalls-node-creating-pages-js":["/component---src-pages-deepdive-gatsby-apicalls-node-creating-pages-js-9a1badda2b85402299ec.js"],"component---src-pages-deepdive-gatsby-apicalls-node-index-js":["/component---src-pages-deepdive-gatsby-apicalls-node-index-js-75ac4981820e72b02ac7.js"],"component---src-pages-deepdive-gatsby-debugging-js":["/component---src-pages-deepdive-gatsby-debugging-js-289a7563f1d47c52ffac.js"],"component---src-pages-deepdive-gatsby-index-js":["/component---src-pages-deepdive-gatsby-index-js-e7b7db76472828d679e8.js"],"component---src-pages-deepdive-gatsby-plugins-js":["/component---src-pages-deepdive-gatsby-plugins-js-1d2f0cc300cd9a0df475.js"],"component---src-pages-deepdive-mdxplugin-js":["/component---src-pages-deepdive-mdxplugin-js-ff1e0bd02065d047b9bb.js"],"component---src-pages-index-js":["/component---src-pages-index-js-a23928b879e6dd0adc58.js"],"component---src-pages-mdx-mdx":["/component---src-pages-mdx-mdx-a0916c906b3d8eac84ca.js"],"component---src-templates-dynamic-page-template-js":["/component---src-templates-dynamic-page-template-js-5b35e311d2f48f0b9bdd.js"]};/*]]>*/</script><script src="/DemoGatsby/polyfill-fd5502421d629d1c910a.js" nomodule=""></script><script src="/DemoGatsby/component---src-pages-deepdive-gatsby-plugins-js-1d2f0cc300cd9a0df475.js" async=""></script><script src="/DemoGatsby/5b193f6accaeb9908c3d71638f39c22a959f684d-91cf4c8dc2f322fa6180.js" async=""></script><script src="/DemoGatsby/app-444659934cb01ee83c7c.js" async=""></script><script src="/DemoGatsby/framework-33b76a5d919ecf8a8684.js" async=""></script><script src="/DemoGatsby/webpack-runtime-4fdd00d27d183d75dcd4.js" async=""></script></body></html>