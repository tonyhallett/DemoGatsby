<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 3.14.0"/><link as="script" rel="preload" href="/DemoGatsby/webpack-runtime-4fdd00d27d183d75dcd4.js"/><link as="script" rel="preload" href="/DemoGatsby/framework-33b76a5d919ecf8a8684.js"/><link as="script" rel="preload" href="/DemoGatsby/app-444659934cb01ee83c7c.js"/><link as="script" rel="preload" href="/DemoGatsby/5b193f6accaeb9908c3d71638f39c22a959f684d-91cf4c8dc2f322fa6180.js"/><link as="script" rel="preload" href="/DemoGatsby/component---src-pages-deepdive-gatsby-apicalls-node-index-js-75ac4981820e72b02ac7.js"/><link as="fetch" rel="preload" href="/DemoGatsby/page-data/deepdive/gatsby/apicalls/node/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/DemoGatsby/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><main><title>API calls</title><p>The gatsby node api calls can be tracked in source code by looking for <code>apiRunnerNode(</code></p><p>When gatsby needs to run a node api function it is the <a rel="noreferrer" target="_blank">apiRunnerNode</a> that provides the logic.</p><p>Simplifying a little, for all plugins that implement the node function ( with a filter to avoid infinite loop ), gatsby-node.js is <a rel="noreferrer" target="_blank">is required</a> ( and the plugin is cached ).</p><p>The redux actions ( action creators ) that will be made available to the api function are bound which means their return value is automatically dispatched.  If they return a function then that function is passed the dispatch function.  Of the public actions the createNode action is of this type and will use the dispatch function.  More on this in a moment.</p><p>From redux ( omitting non essential code ) - <a rel="noreferrer" target="_blank">bindActionCreators</a></p><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff"><code class="language-javascript" style="white-space:pre"><span>
</span><span>  </span><span style="color:#954121">export</span><span> </span><span style="color:#954121">default</span><span> </span><span class="hljs-function" style="color:#954121">function</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#458;font-weight:bold">bindActionCreators</span><span class="hljs-function">(</span><span class="hljs-function" style="color:#00f">
</span><span class="hljs-function" style="color:#00f">    actionCreators: ActionCreator&lt;any&gt; | ActionCreatorsMapObject,
</span><span class="hljs-function" style="color:#00f">    dispatch: Dispatch
</span><span class="hljs-function" style="color:#00f">  </span><span class="hljs-function">) </span><span>{
</span><span>    </span><span style="color:#954121">if</span><span> (</span><span style="color:#954121">typeof</span><span> actionCreators === </span><span style="color:#219161">&#x27;function&#x27;</span><span>) {
</span><span>      </span><span style="color:#954121">return</span><span> bindActionCreator(actionCreators, dispatch)
</span>    }
<span>    </span><span style="color:#954121">const</span><span> boundActionCreators: ActionCreatorsMapObject = {}
</span><span>    </span><span style="color:#954121">for</span><span> (</span><span style="color:#954121">const</span><span> key </span><span style="color:#954121">in</span><span> actionCreators) {
</span><span>      </span><span style="color:#954121">const</span><span> actionCreator = actionCreators[key]
</span><span>      </span><span style="color:#954121">if</span><span> (</span><span style="color:#954121">typeof</span><span> actionCreator === </span><span style="color:#219161">&#x27;function&#x27;</span><span>) {
</span>        boundActionCreators[key] = bindActionCreator(actionCreator, dispatch)
<!-- -->      }
<!-- -->    }
<span>    </span><span style="color:#954121">return</span><span> boundActionCreators
</span>  }
<!-- -->
<span>  </span><span class="hljs-function" style="color:#954121">function</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#458;font-weight:bold">bindActionCreator</span><span class="hljs-function">&lt;</span><span class="hljs-function" style="color:#458;font-weight:bold">A</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#458;font-weight:bold">extends</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#458;font-weight:bold">AnyAction</span><span class="hljs-function"> = </span><span class="hljs-function" style="color:#458;font-weight:bold">AnyAction</span><span class="hljs-function">&gt;(</span><span class="hljs-function" style="color:#00f">
</span><span class="hljs-function" style="color:#00f">    actionCreator: ActionCreator&lt;A&gt;,
</span><span class="hljs-function" style="color:#00f">    dispatch: Dispatch
</span><span class="hljs-function" style="color:#00f">  </span><span class="hljs-function">) </span><span>{
</span><span>    </span><span style="color:#954121">return</span><span> </span><span class="hljs-function" style="color:#954121">function</span><span class="hljs-function"> (</span><span class="hljs-function" style="color:#0086b3">this</span><span class="hljs-function" style="color:#00f">: any, ...args: any[]</span><span class="hljs-function">) </span><span>{
</span><span>      </span><span style="color:#954121">return</span><span> dispatch(actionCreator.apply(</span><span style="color:#0086b3">this</span><span>, args))
</span>    }
<!-- -->  }
<!-- -->  
</code></pre><p>It is redux-thunk that provides action functions - <a rel="noreferrer" target="_blank">see</a> </p><p>Then the bound action creators are then double bound.  The action creators can take 1-3 arguments.  The  third argument is not provided by the caller but is the same <b>api specific</b> &quot;arguments&quot; object that the api function will receive as its first argument. If an action creator takes two arguments then the second argument is a plugin argument.  If you do not specify then the plugin is the plugin being run.  From the code comments this functionality is limited and you would need to understand the action.</p><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff"><code class="language-javascript" style="white-space:pre"><span>
</span><span>          doubleBoundActionCreators[key] = </span><span class="hljs-function">(</span><span class="hljs-function" style="color:#00f">...args</span><span class="hljs-function">) =&gt;</span><span> {
</span><span>            </span><span style="color:#408080;font-style:italic">// Let action callers override who the plugin is. Shouldn&#x27;t be</span><span>
</span><span>            </span><span style="color:#408080;font-style:italic">// used that often.</span><span>
</span><span>            </span><span style="color:#954121">if</span><span> (args.length === </span><span style="color:#40a070">1</span><span>) {
</span><span>              </span><span style="color:#954121">return</span><span> boundActionCreator(args[</span><span style="color:#40a070">0</span><span>], plugin, actionOptions)
</span><span>            } </span><span style="color:#954121">else</span><span> </span><span style="color:#954121">if</span><span> (args.length === </span><span style="color:#40a070">2</span><span>) {
</span><span>              </span><span style="color:#954121">return</span><span> boundActionCreator(args[</span><span style="color:#40a070">0</span><span>], args[</span><span style="color:#40a070">1</span><span>], actionOptions)
</span>            }
<span>            </span><span style="color:#954121">return</span><span> </span><span style="color:#954121">undefined</span><span>
</span>          }
<!-- -->  
</code></pre><p>Then the node api function is invoked with two arguments.  The first argument is an object with fields that are common for all api functions and ones that are particular to it <a rel="noreferrer" target="_blank">fields that are common for all api functions and ones that are particular to it</a>.  The second argument is the plugin&#x27;s options.  A node api function can have as a third argument a callback, of course returning a promise is better.</p><p>The firt argument is known as in the docs as <a rel="noreferrer" target="_blank">node api helpers</a>.  Some of these are described as internal such as the emitter and the redux store.  To see the slices available from the store see <a rel="noreferrer" target="_blank">redux reducers folder</a>.</p><p>The emitter emits named events with the emiyt method.  What this means is that all handlers that have subscribed to the event name will be notified.  It is also possible to subscribe to all events using <a rel="noreferrer" target="_blank">*</a>.</p><p>The emitter emits whenever the <a rel="noreferrer" target="_blank">redux store has been updated</a></p><p><code>loadNodeContent(node)</code> - Will the first time it is called ask the plugin that created the node to <code>loadNodeContent</code> </p><p>actions - These can be found <a rel="noreferrer" target="_blank">here</a></p><ol><li></li></ol></main></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/deepdive/gatsby/apicalls/node/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-fd5502421d629d1c910a.js"],"app":["/app-444659934cb01ee83c7c.js"],"component---src-pages-404-js":["/component---src-pages-404-js-da19968e4b00979f9461.js"],"component---src-pages-deepdive-cli-js":["/component---src-pages-deepdive-cli-js-0f18bb1c833ee538d1f1.js"],"component---src-pages-deepdive-gatsby-apicalls-node-creating-nodes-js":["/component---src-pages-deepdive-gatsby-apicalls-node-creating-nodes-js-221ff46555a3e8320634.js"],"component---src-pages-deepdive-gatsby-apicalls-node-creating-pages-js":["/component---src-pages-deepdive-gatsby-apicalls-node-creating-pages-js-9a1badda2b85402299ec.js"],"component---src-pages-deepdive-gatsby-apicalls-node-index-js":["/component---src-pages-deepdive-gatsby-apicalls-node-index-js-75ac4981820e72b02ac7.js"],"component---src-pages-deepdive-gatsby-debugging-js":["/component---src-pages-deepdive-gatsby-debugging-js-289a7563f1d47c52ffac.js"],"component---src-pages-deepdive-gatsby-index-js":["/component---src-pages-deepdive-gatsby-index-js-e7b7db76472828d679e8.js"],"component---src-pages-deepdive-gatsby-plugins-js":["/component---src-pages-deepdive-gatsby-plugins-js-1d2f0cc300cd9a0df475.js"],"component---src-pages-deepdive-mdxplugin-js":["/component---src-pages-deepdive-mdxplugin-js-ff1e0bd02065d047b9bb.js"],"component---src-pages-index-js":["/component---src-pages-index-js-a23928b879e6dd0adc58.js"],"component---src-pages-mdx-mdx":["/component---src-pages-mdx-mdx-a0916c906b3d8eac84ca.js"],"component---src-templates-dynamic-page-template-js":["/component---src-templates-dynamic-page-template-js-5b35e311d2f48f0b9bdd.js"]};/*]]>*/</script><script src="/DemoGatsby/polyfill-fd5502421d629d1c910a.js" nomodule=""></script><script src="/DemoGatsby/component---src-pages-deepdive-gatsby-apicalls-node-index-js-75ac4981820e72b02ac7.js" async=""></script><script src="/DemoGatsby/5b193f6accaeb9908c3d71638f39c22a959f684d-91cf4c8dc2f322fa6180.js" async=""></script><script src="/DemoGatsby/app-444659934cb01ee83c7c.js" async=""></script><script src="/DemoGatsby/framework-33b76a5d919ecf8a8684.js" async=""></script><script src="/DemoGatsby/webpack-runtime-4fdd00d27d183d75dcd4.js" async=""></script></body></html>